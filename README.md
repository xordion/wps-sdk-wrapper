# WPS SDK Wrapper

A **framework-agnostic** utility toolkit for WPS WebOffice SDK integration. Works seamlessly with React, Vue, Angular, or vanilla JavaScript.

‰∏Ä‰∏™**Ê°ÜÊû∂Êó†ÂÖ≥**ÁöÑ WPS WebOffice SDK Â∑•ÂÖ∑Â∫ì„ÄÇÂèØ‰∏é React„ÄÅVue„ÄÅAngular ÊàñÂéüÁîü JavaScript Êó†ÁºùÈÖçÂêà‰ΩøÁî®„ÄÇ

## ‚ú® Features / ÁâπÊÄß

- üöÄ **Framework Agnostic** - Works with any JavaScript framework or vanilla JS / **Ê°ÜÊû∂Êó†ÂÖ≥** - ÂèØ‰∏é‰ªª‰Ωï JavaScript Ê°ÜÊû∂ÊàñÂéüÁîü JS ÈÖçÂêà‰ΩøÁî®
- üõ†Ô∏è **Rich Utilities** - Comprehensive toolkit for document operations / **‰∏∞ÂØåÂ∑•ÂÖ∑** - Êèê‰æõÂÖ®Èù¢ÁöÑÊñáÊ°£Êìç‰ΩúÂ∑•ÂÖ∑ÈõÜ
- üìù **TypeScript Support** - Full TypeScript definitions included / **TypeScript ÊîØÊåÅ** - ÂåÖÂê´ÂÆåÊï¥ÁöÑ TypeScript Á±ªÂûãÂÆö‰πâ
- üéØ **Modern Development** - Built with modern JavaScript patterns / **Áé∞‰ª£ÂºÄÂèë** - ‰ΩøÁî®Áé∞‰ª£ JavaScript Ê®°ÂºèÊûÑÂª∫
- üì¶ **Tree Shaking** - Supports tree shaking for optimal bundle size / **Tree Shaking** - ÊîØÊåÅ tree shakingÔºå‰ºòÂåñÊâìÂåÖ‰ΩìÁßØ
- üîß **Zero Dependencies** - Core library has no framework dependencies / **Èõ∂‰æùËµñ** - Ê†∏ÂøÉÂ∫ìÊó†Ê°ÜÊû∂‰æùËµñ

## üì¶ Installation / ÂÆâË£Ö

```bash
npm install wps-sdk-wrapper
```

## üõ†Ô∏è Available Utilities / ÂèØÁî®Â∑•ÂÖ∑ÊñπÊ≥ï

### Initialization / ÂàùÂßãÂåñÁõ∏ÂÖ≥
- `initWPS` - Initialize WPS instance / ÂàùÂßãÂåñ WPS ÂÆû‰æã
- `getWPSApplication` - Get WPS application instance / Ëé∑Âèñ WPS Â∫îÁî®Á®ãÂ∫èÂÆû‰æã
- `setDocumentReadOnly` - Set document read-only status / ËÆæÁΩÆÊñáÊ°£Âè™ËØªÁä∂ÊÄÅ

### Text Operations / ÊñáÊú¨Êìç‰Ωú
- `searchAndLocateText` - Search and locate text in document / ÊêúÁ¥¢Âπ∂ÂÆö‰ΩçÊñáÊ°£‰∏≠ÁöÑÊñáÊú¨
- `insertTextAtCursor` - Insert text at cursor position / Âú®ÂÖâÊ†á‰ΩçÁΩÆÊèíÂÖ•ÊñáÊú¨
- `clearHitHighlight` - Clear text highlighting / Ê∏ÖÈô§ÊñáÊú¨È´ò‰∫Æ
- `replaceOriginalContent` - Replace original content / ÊõøÊç¢ÂéüÂßãÂÜÖÂÆπ

### Document Management / ÊñáÊ°£ÁÆ°ÁêÜ
- `saveDocument` - Save document / ‰øùÂ≠òÊñáÊ°£
- `getDocLength` - Get document length / Ëé∑ÂèñÊñáÊ°£ÈïøÂ∫¶
- `formatDocumentFont` - Format document font / Ê†ºÂºèÂåñÊñáÊ°£Â≠ó‰Ωì

### Revision Management / ‰øÆËÆ¢ÁÆ°ÁêÜ
- `getLatestRevisionDate` - Get latest revision date / Ëé∑ÂèñÊúÄÊñ∞‰øÆËÆ¢Êó•Êúü
- `collectRevisionInfos` - Collect revision information / Êî∂ÈõÜ‰øÆËÆ¢‰ø°ÊÅØ
- `handleMatchingRevisions` - Accept/reject matching revisions / Êé•Âèó/ÊãíÁªùÂåπÈÖçÁöÑ‰øÆËÆ¢
- `handleRevisionContent` - Handle revision content / Â§ÑÁêÜ‰øÆËÆ¢ÂÜÖÂÆπ

## üìö API Reference / API ÂèÇËÄÉ

### initWPS Options

```typescript
interface InitWPSOptions {
  fileId: string;                    // Êñá‰ª∂ID
  appId: string;                     // Â∫îÁî®ID
  containerSelector: string;         // ÂÆπÂô®ÈÄâÊã©Âô®
  onReady?: (wps: any, app: any) => void;     // ÂàùÂßãÂåñÂÆåÊàêÂõûË∞É
  onError?: (error: any) => void;             // ÈîôËØØÂõûË∞É
  isReadOnly: boolean;               // ÊòØÂê¶Âè™ËØª
  token?: string;                    // ËÆøÈóÆ‰ª§Áâå
  simple?: boolean;                  // ÁÆÄÂçïÊ®°Âºè
  refreshToken?: (token: string, timeout?: number) => void;  // Âà∑Êñ∞‰ª§ÁâåÂáΩÊï∞
  [key: string]: any;               // ÂÖ∂‰ªñËá™ÂÆö‰πâÂèÇÊï∞
}
```

### Basic Usage / Âü∫Êú¨Áî®Ê≥ï

```javascript
import { initWPS, searchAndLocateText, insertTextAtCursor } from 'wps-sdk-wrapper';

// Initialize WPS / ÂàùÂßãÂåñ WPS
const wpsInstance = await initWPS({
  fileId: "your-file-id",
  appId: "your-app-id",
  containerSelector: ".wps-container",
  onReady: (wps, app) => {
    console.log('WPS initialized / WPS ÂàùÂßãÂåñÊàêÂäü', wps, app);
  },
  isReadOnly: false
});
```

## üìÑ License / ËÆ∏ÂèØËØÅ

MIT License - see [LICENSE](LICENSE) file for details.

MIT ËÆ∏ÂèØËØÅ - Êü•Áúã [LICENSE](LICENSE) Êñá‰ª∂‰∫ÜËß£ËØ¶ÊÉÖ„ÄÇ

---

## üöÄ Framework Examples / Ê°ÜÊû∂Á§∫‰æã

### Vanilla JavaScript / ÂéüÁîü JavaScript

```javascript
import { initWPS, searchAndLocateText, insertTextAtCursor } from 'wps-sdk-wrapper';

// Initialize WPS
const wpsInstance = await initWPS({
  fileId: "your-file-id",
  appId: "your-app-id",
  containerSelector: ".wps-container",
  onReady: (wps, app) => {
    console.log('WPS initialized successfully', wps, app);
    window.wpsApp = app; // Store for later use
  },
  onError: (error) => {
    console.error('WPS initialization failed', error);
  },
  isReadOnly: false
});

// Use utilities
async function searchText() {
  const result = await searchAndLocateText(window.wpsApp, 'search text', true);
  if (result) {
    console.log('Text found at position:', result.pos);
  }
}

async function insertText() {
  await insertTextAtCursor(window.wpsApp, 'Hello from vanilla JS!');
}
```

### React Integration / React ÈõÜÊàê

```jsx
import React, { useEffect, useRef, useState } from 'react';
import { initWPS, searchAndLocateText, insertTextAtCursor, saveDocument } from 'wps-sdk-wrapper';

function WPSComponent() {
  const [app, setApp] = useState(null);
  const containerRef = useRef(null);

  useEffect(() => {
    const initializeWPS = async () => {
      try {
        const result = await initWPS({
          fileId: "your-file-id",
          appId: "your-app-id",
          containerSelector: ".wps-container",
          onReady: (wps, app) => {
            setApp(app);
            console.log('WPS ready in React');
          },
          onError: (error) => {
            console.error('WPS error:', error);
          },
          isReadOnly: false
        });
      } catch (error) {
        console.error('Failed to initialize WPS:', error);
      }
    };

    initializeWPS();
  }, []);

  const handleSearch = async () => {
    if (!app) return;
    const result = await searchAndLocateText(app, 'React', true);
    console.log('Search result:', result);
  };

  const handleInsert = async () => {
    if (!app) return;
    await insertTextAtCursor(app, 'Text from React component!');
  };

  const handleSave = async () => {
    if (!app) return;
    await saveDocument(app);
  };

  return (
    <div>
      <div className="controls">
        <button onClick={handleSearch}>Search Text</button>
        <button onClick={handleInsert}>Insert Text</button>
        <button onClick={handleSave}>Save Document</button>
      </div>
      <div 
        className="wps-container" 
        ref={containerRef}
        style={{ width: '100%', height: '600px' }}
      />
    </div>
  );
}

export default WPSComponent;
```

### Vue.js Integration / Vue.js ÈõÜÊàê

```vue
<template>
  <div>
    <div class="controls">
      <button @click="searchText">Search Text</button>
      <button @click="insertText">Insert Text</button>
      <button @click="saveDoc">Save Document</button>
    </div>
    <div 
      class="wps-container" 
      ref="wpsContainer"
      style="width: 100%; height: 600px;"
    />
  </div>
</template>

<script>
import { initWPS, searchAndLocateText, insertTextAtCursor, saveDocument } from 'wps-sdk-wrapper';

export default {
  name: 'WPSComponent',
  data() {
    return {
      wpsApp: null,
      wpsInstance: null
    };
  },
  async mounted() {
    try {
      await this.initializeWPS();
    } catch (error) {
      console.error('Failed to initialize WPS:', error);
    }
  },
  methods: {
    async initializeWPS() {
      const result = await initWPS({
        fileId: "your-file-id",
        appId: "your-app-id",
        containerSelector: ".wps-container",
        onReady: (wps, app) => {
          this.wpsInstance = wps;
          this.wpsApp = app;
          console.log('WPS ready in Vue');
        },
        onError: (error) => {
          console.error('WPS error:', error);
        },
        isReadOnly: false
      });
    },
    async searchText() {
      if (!this.wpsApp) return;
      const result = await searchAndLocateText(this.wpsApp, 'Vue', true);
      console.log('Search result:', result);
    },
    async insertText() {
      if (!this.wpsApp) return;
      await insertTextAtCursor(this.wpsApp, 'Text from Vue component!');
    },
    async saveDoc() {
      if (!this.wpsInstance) return;
      await saveDocument(this.wpsInstance);
    }
  },
  beforeUnmount() {
    // Cleanup if needed
    if (this.wpsInstance) {
      // Add any cleanup logic here
    }
  }
};
</script>
```

### Vue 3 Composition API / Vue 3 ÁªÑÂêàÂºè API

```vue
<template>
  <div>
    <div class="controls">
      <button @click="searchText">Search Text</button>
      <button @click="insertText">Insert Text</button>
      <button @click="saveDoc">Save Document</button>
    </div>
    <div 
      class="wps-container" 
      ref="wpsContainer"
      style="width: 100%; height: 600px;"
    />
  </div>
</template>

<script setup>
import { ref, onMounted, onUnmounted } from 'vue';
import { initWPS, searchAndLocateText, insertTextAtCursor, saveDocument } from 'wps-sdk-wrapper';

const wpsContainer = ref(null);
const wpsApp = ref(null);
const wpsInstance = ref(null);

onMounted(async () => {
  try {
    await initializeWPS();
  } catch (error) {
    console.error('Failed to initialize WPS:', error);
  }
});

const initializeWPS = async () => {
  const result = await initWPS({
    fileId: "your-file-id",
    appId: "your-app-id",
    containerSelector: ".wps-container",
    onReady: (wps, app) => {
      wpsInstance.value = wps;
      wpsApp.value = app;
      console.log('WPS ready in Vue 3');
    },
    onError: (error) => {
      console.error('WPS error:', error);
    },
    isReadOnly: false
  });
};

const searchText = async () => {
  if (!wpsApp.value) return;
  const result = await searchAndLocateText(wpsApp.value, 'Vue 3', true);
  console.log('Search result:', result);
};

const insertText = async () => {
  if (!wpsApp.value) return;
  await insertTextAtCursor(wpsApp.value, 'Text from Vue 3 Composition API!');
};

const saveDoc = async () => {
  if (!wpsInstance.value) return;
  await saveDocument(wpsInstance.value);
};

onUnmounted(() => {
  // Cleanup if needed
});
</script>
```

### Angular Integration / Angular ÈõÜÊàê

```typescript
// wps.service.ts
import { Injectable } from '@angular/core';
import { initWPS, searchAndLocateText, insertTextAtCursor, saveDocument } from 'wps-sdk-wrapper';

@Injectable({
  providedIn: 'root'
})
export class WPSService {
  private wpsApp: any = null;
  private wpsInstance: any = null;

  async initializeWPS(config: any): Promise<void> {
    try {
      await initWPS({
        ...config,
        onReady: (wps: any, app: any) => {
          this.wpsInstance = wps;
          this.wpsApp = app;
          console.log('WPS ready in Angular');
        },
        onError: (error: any) => {
          console.error('WPS error:', error);
        }
      });
    } catch (error) {
      console.error('Failed to initialize WPS:', error);
      throw error;
    }
  }

  async searchText(text: string): Promise<any> {
    if (!this.wpsApp) return null;
    return await searchAndLocateText(this.wpsApp, text, true);
  }

  async insertText(text: string): Promise<void> {
    if (!this.wpsApp) return;
    await insertTextAtCursor(this.wpsApp, text);
  }

  async saveDocument(): Promise<void> {
    if (!this.wpsInstance) return;
    await saveDocument(this.wpsInstance);
  }

  getApp(): any {
    return this.wpsApp;
  }
}
```

```typescript
// wps.component.ts
import { Component, OnInit, OnDestroy } from '@angular/core';
import { WPSService } from './wps.service';

@Component({
  selector: 'app-wps',
  template: `
    <div>
      <div class="controls">
        <button (click)="searchText()">Search Text</button>
        <button (click)="insertText()">Insert Text</button>
        <button (click)="saveDoc()">Save Document</button>
      </div>
      <div 
        class="wps-container" 
        style="width: 100%; height: 600px;">
      </div>
    </div>
  `
})
export class WPSComponent implements OnInit, OnDestroy {

  constructor(private wpsService: WPSService) {}

  async ngOnInit() {
    try {
      await this.wpsService.initializeWPS({
        fileId: "your-file-id",
        appId: "your-app-id",
        containerSelector: ".wps-container",
        isReadOnly: false
      });
    } catch (error) {
      console.error('Failed to initialize WPS:', error);
    }
  }

  async searchText() {
    const result = await this.wpsService.searchText('Angular');
    console.log('Search result:', result);
  }

  async insertText() {
    await this.wpsService.insertText('Text from Angular component!');
  }

  async saveDoc() {
    await this.wpsService.saveDocument();
  }

  ngOnDestroy() {
    // Cleanup if needed
  }
}
```

## üîß Development / ÂºÄÂèë

```bash
# Install dependencies / ÂÆâË£Ö‰æùËµñ
npm install

# Start development server (React example) / ÂêØÂä®ÂºÄÂèëÊúçÂä°Âô®ÔºàReactÁ§∫‰æãÔºâ
npm run dev

# Build library / ÊûÑÂª∫Â∫ì
npm run build

# Build example / ÊûÑÂª∫Á§∫‰æã
npm run build:example
```

## üí° Design Advantages / ËÆæËÆ°‰ºòÂäø

1. **Framework Agnostic** - Core code has no specific framework dependencies / **Ê°ÜÊû∂Êó†ÂÖ≥** - Ê†∏ÂøÉ‰ª£Á†Å‰∏ç‰æùËµñ‰ªª‰ΩïÁâπÂÆöÊ°ÜÊû∂
2. **Flexible Integration** - Easy integration into any modern frontend framework / **ÁÅµÊ¥ªÈõÜÊàê** - ÂèØËΩªÊùæÈõÜÊàêÂà∞‰ªª‰ΩïÁé∞‰ª£ÂâçÁ´ØÊ°ÜÊû∂‰∏≠
3. **Type Safe** - Full TypeScript support / **Á±ªÂûãÂÆâÂÖ®** - ÂÆåÊï¥ÁöÑ TypeScript ÊîØÊåÅ
4. **Tree Shaking** - Supports on-demand imports / **ÊåâÈúÄÂØºÂÖ•** - ÊîØÊåÅÊåâÈúÄÂØºÂÖ•ÔºåÂáèÂ∞ëÊâìÂåÖ‰ΩìÁßØ
5. **Easy Extension** - New features can be easily added / **Êòì‰∫éÊâ©Â±ï** - Êñ∞Â¢ûÂäüËÉΩÂè™ÈúÄÊ∑ªÂä†Âà∞Â∑•ÂÖ∑ÈõÜÂπ∂ÂØºÂá∫

## üìÅ Project Structure / È°πÁõÆÁªìÊûÑ

```
wps-sdk-wrapper/
‚îú‚îÄ‚îÄ index.ts          # Main entry file (framework-agnostic) / ‰∏ªÂÖ•Âè£Êñá‰ª∂ÔºàÊ°ÜÊû∂Êó†ÂÖ≥Ôºâ
‚îú‚îÄ‚îÄ src/              # React example project / React Á§∫‰æãÈ°πÁõÆÊ∫êÁ†Å
‚îÇ   ‚îú‚îÄ‚îÄ App.tsx       # React example app / React Á§∫‰æãÂ∫îÁî®
‚îÇ   ‚îú‚îÄ‚îÄ main.tsx      # React example entry / React Á§∫‰æãÂÖ•Âè£
‚îÇ   ‚îî‚îÄ‚îÄ mockWPSSDK.ts # Mock SDK
‚îú‚îÄ‚îÄ sdk/              # WPS SDK files / WPS SDK Êñá‰ª∂
‚îú‚îÄ‚îÄ dist/             # Build output / ÊûÑÂª∫ËæìÂá∫ÁõÆÂΩï
‚îî‚îÄ‚îÄ README.md         # Documentation / ËØ¥ÊòéÊñáÊ°£
```

## ü§ù Contributing / Ë¥°ÁåÆ

Contributions are welcome! Please feel free to submit a Pull Request.

Ê¨¢ËøéË¥°ÁåÆÔºÅËØ∑ÈöèÊó∂Êèê‰∫§ Pull Request„ÄÇ

## üåê Related Links / Áõ∏ÂÖ≥ÈìæÊé•

- [WPS Open Platform / WPS ÂºÄÊîæÂπ≥Âè∞](https://wwo.wps.cn/)
- [React Official Documentation / React ÂÆòÊñπÊñáÊ°£](https://reactjs.org/)
- [Vue.js Official Documentation / Vue.js ÂÆòÊñπÊñáÊ°£](https://vuejs.org/)
- [Angular Official Documentation / Angular ÂÆòÊñπÊñáÊ°£](https://angular.io/)
- [TypeScript Official Documentation / TypeScript ÂÆòÊñπÊñáÊ°£](https://www.typescriptlang.org/)